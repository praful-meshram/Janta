/*
 * Generated by the Jasper component of Apache Tomcat
 * Version: Apache Tomcat/7.0.42
 * Generated at: 2014-02-07 11:29:35 UTC
 * Note: The last modified time of this file was set to
 *       the last modified time of the source file after
 *       generation to assist with modification tracking.
 */
package org.apache.jsp;

import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.jsp.*;
import java.sql.*;
import javax.naming.*;
import javax.sql.*;
import java.text.*;
import java.io.*;

public final class DeliveryDetailsForm_jsp extends org.apache.jasper.runtime.HttpJspBase
    implements org.apache.jasper.runtime.JspSourceDependent {

  private static final javax.servlet.jsp.JspFactory _jspxFactory =
          javax.servlet.jsp.JspFactory.getDefaultFactory();

  private static java.util.Map<java.lang.String,java.lang.Long> _jspx_dependants;

  private javax.el.ExpressionFactory _el_expressionfactory;
  private org.apache.tomcat.InstanceManager _jsp_instancemanager;

  public java.util.Map<java.lang.String,java.lang.Long> getDependants() {
    return _jspx_dependants;
  }

  public void _jspInit() {
    _el_expressionfactory = _jspxFactory.getJspApplicationContext(getServletConfig().getServletContext()).getExpressionFactory();
    _jsp_instancemanager = org.apache.jasper.runtime.InstanceManagerFactory.getInstanceManager(getServletConfig());
  }

  public void _jspDestroy() {
  }

  public void _jspService(final javax.servlet.http.HttpServletRequest request, final javax.servlet.http.HttpServletResponse response)
        throws java.io.IOException, javax.servlet.ServletException {

    final javax.servlet.jsp.PageContext pageContext;
    javax.servlet.http.HttpSession session = null;
    final javax.servlet.ServletContext application;
    final javax.servlet.ServletConfig config;
    javax.servlet.jsp.JspWriter out = null;
    final java.lang.Object page = this;
    javax.servlet.jsp.JspWriter _jspx_out = null;
    javax.servlet.jsp.PageContext _jspx_page_context = null;


    try {
      response.setContentType("text/html");
      pageContext = _jspxFactory.getPageContext(this, request, response,
      			"ErrorPage.jsp?page=DeliveryDetailsForm.jsp", true, 8192, true);
      _jspx_page_context = pageContext;
      application = pageContext.getServletContext();
      config = pageContext.getServletConfig();
      session = pageContext.getSession();
      out = pageContext.getOut();
      _jspx_out = out;

      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\n");
      org.apache.jasper.runtime.JspRuntimeLibrary.include(request, response, "header.jsp", out, false);
      out.write('\n');
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("\t\n");
      out.write("\t");

	session.getAttribute("UserName").toString();
	//System.out.println("session bachka maapping : "+session +" \n user "+session.getAttribute("UserName").toString());
	
      out.write("\n");
      out.write("\n");
      out.write("\n");
      out.write("<script src=\"js/lastOrderDetails.js\"></script>\n");

	String StrWithComma="";
	String[] actionValueArray=null;
	String[] arr=null;
	int count=0;
  	String orderNo=""; 	
  	orderNo=request.getParameter("orderNo");
  	String custCode="";
  	String action1="",action2="",actionValue="";
  	String deliveryBalance="";
  	String subValue="";
  	subValue=request.getParameter("subValue");
  	String name="";
  	String phno="";
  	String area="";
  	String add1="";
  	String add2="";
  	String orderDate="";
  	String status="";
  	String totalItems=""; 
	String payment_type_desc=""; 	
  	float balance=0.0f;
  	float advance=0.0f;
  	float discount=0.0f;
  	float changeAmt=0.0f;
  	float comm_amt=0.0f;	  	
  	float totalValue=0.0f;
  	float other_charges=0.0f;

	order.ManageOrder mo;
	mo = new order.ManageOrder("jdbc/js");
	mo.getOrderDetails(orderNo);
	
	while(mo.rs.next()){		
		custCode = mo.rs.getString("custcode");
	  	name = mo.rs.getString("custname");
	  	phno = mo.rs.getString("phone");
	  	area = mo.rs.getString("area");
	  	add1 = mo.rs.getString("add1");
	  	add2 = mo.rs.getString("add2");
	  	balance = mo.rs.getFloat("balance_amt");
	  	advance = mo.rs.getFloat("advance_amt");
	  	discount = mo.rs.getFloat("discount_amt");
		orderDate = mo.rs.getString("order_date");
	  	status=mo.rs.getString("status_code");
	  	changeAmt=mo.rs.getFloat("change_amt");
	  	totalItems = mo.rs.getString("total_items");
	  	totalValue = mo.rs.getFloat("total_value");	
	  	comm_amt = mo.rs.getFloat("ord_comm_amt");	
	  	other_charges = mo.rs.getFloat("other_charges");	
	 	payment_type_desc = mo.rs.getString("payment_type_desc");	  		  	
	}
	mo.closeAll();
		

      out.write("\n");
      out.write("<form name=\"myform\" method=\"post\" class=\"ddm1\">\n");
      out.write("\t<table align=l style=\"border-collapse: collapse;\">\n");
      out.write("\t<tr>\n");
      out.write("    \t<td align=\"left\"><b><font color=\"blue\" size =\"1.8\">Current Status :</font><b></td>\n");
      out.write("    \t<td align=\"left\"><b><label id='status' ></label></label><b></td>\n");
      out.write("    \t<td colspan=4></td>\n");
      out.write("    \t<td align=\"left\"><b><font color=\"blue\" size =\"1.8\">Next Action :</font></b></td>\n");
      out.write("    \t<td align=\"left\"><b><label id='action' ></label><b></td>\n");
      out.write("    </tr>\n");
      out.write("\t</table>\n");
      out.write("\t<table width=\"100%\">\n");
      out.write("\t<tr><td colspan=8></td><td>\n");
      out.write("    <table id=\"1\"  width=\"100%\">\n");
      out.write("\t<tr><th colspan=\"6\"><center><b>Customer Information</b></center> </th></tr>\n");
      out.write("\t<tr></tr><TR></TR>\n");
      out.write("\t<tr></tr><TR></TR>\n");
      out.write("\t<tr>\n");
      out.write("\t\t\n");
      out.write("\t\t<td align=\"left\"><b>Customer Code</b></td>\n");
      out.write("\t\t<td align=\"left\">: ");
      out.print(custCode);
      out.write("</td>\n");
      out.write("\t\t<td align=\"left\"><b>Area</b></td>\n");
      out.write("\t\t<td align=\"left\">: ");
      out.print(area);
      out.write(" </td>\n");
      out.write("\t\t\n");
      out.write("\t</tr>\n");
      out.write("\t<tr>\n");
      out.write("\t\t\n");
      out.write("\t\t<td align=\"left\"><b>Customer Name</b></td>\n");
      out.write("\t\t<td align=\"left\">: ");
      out.print(name);
      out.write("</td>\n");
      out.write("\t\t<td align=\"left\"><b>Address 1</b></td>\n");
      out.write("\t\t<td align=\"left\">: ");
      out.print(add1);
      out.write("</td>\n");
      out.write("\t</tr>\n");
      out.write("\t<tr>\n");
      out.write("\t\t\n");
      out.write("\t\t<td align=\"left\"><b>Phone</b></td>\n");
      out.write("\t\t<td align=\"left\">: ");
      out.print(phno);
      out.write("</td>\n");
      out.write("\t\t<td align=\"left\"><b>Address 2</b></td>\n");
      out.write("\t\t<td align=\"left\">: ");
      out.print(add2);
      out.write("</td>\n");
      out.write("\t</tr>\n");
      out.write("\t</table><br>\n");
      out.write("\t<table width=\"100%\">\t\n");
      out.write("\t\t<tr><th colspan=\"6\"><center><b>Order Information</b></center> </th></tr>\n");
      out.write("\t\t<tr></tr>\n");
      out.write("\t\t<tr>\t\n");
      out.write("\t\t\t<td align=\"left\"><b>Order Number</b></td>\n");
      out.write("\t\t\t<td align=\"left\">: ");
      out.print(orderNo);
      out.write("</td>\n");
      out.write("\t\t\t<td align=\"left\"><b>Order Date</b></td>\n");
      out.write("\t\t\t<td align=\"left\">: ");
      out.print(orderDate);
      out.write("</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t<tr>\t\n");
      out.write("\t\t\t<td align=\"left\"><b>Total Items</b></td>\n");
      out.write("\t\t\t<td align=\"left\">: ");
      out.print(totalItems);
      out.write("</td>\n");
      out.write("\t\t\t<td align=\"left\"><b>Commission</b></td>\n");
      out.write("\t\t\t<td align=\"left\">: ");
      out.print(comm_amt);
      out.write("</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t<tr>\t\n");
      out.write("\t\t\t<td align=\"left\"><b>Total Value</b></td>\n");
      out.write("\t\t\t<td align=\"left\">: ");
      out.print(totalValue);
      out.write("</td>\n");
      out.write("\t\t\t<td width=\"35%\" align=\"left\"><b>Payment Type</b></td>\n");
      out.write("\t\t\t<td align=\"left\">: ");
      out.print(payment_type_desc);
      out.write("</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t\n");
      out.write("\t\t<tr>\t\n");
      out.write("\t\t\t<td align=\"left\"><b>Less Discount</b></td>\n");
      out.write("\t\t\t<td align=\"left\">: ");
      out.print(discount);
      out.write("</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t<tr>\t\n");
      out.write("\t\t\t<td align=\"left\"><b>Less Advance</b></td>\n");
      out.write("\t\t\t<td align=\"left\">:");
      out.print(advance);
      out.write("</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t<tr>\t\n");
      out.write("\t\t\t<td align=\"left\"><b>Balance</b></td>\n");

			if(other_charges > 0){

      out.write("\t\t\t\n");
      out.write("\t\t\t<td align=\"left\">: <font color=\"red\">");
      out.print(balance);
      out.write("</font><font color=\"blue\">, Other Charges : ");
      out.print(other_charges);
      out.write("</font></td>\n");
}else if(other_charges <=0){ 
      out.write("\n");
      out.write("\t\t\t<td align=\"left\">: <font color=\"red\">");
      out.print(balance);
      out.write("</font></td>\n");
}
      out.write("\t\t\t\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t\n");
      out.write("\t\t\n");
      out.write("\t\t<tr>\t\n");
      out.write("\t\t\t<td align=\"left\"><b>Change</b></td>\n");
      out.write("\n");
		if(balance>0){
	 		if(payment_type_desc.equals("Cash") || payment_type_desc.equalsIgnoreCase("Cheque") || payment_type_desc.equals("Credit")){

      out.write("\n");
      out.write("\t\t\t\t<td align=\"left\"> :<input  type=\"text\" readonly value=\"");
      out.print(changeAmt);
      out.write("\" name=\"change\" ></td>\n");
			}else{

      out.write("\n");
      out.write("\t\t\t\t<td align=\"left\"> :<input  type=\"text\" value=\"");
      out.print(changeAmt);
      out.write("\" name=\"change\" onkeyup=\"setExpected();\"></td>\n");
			}
		}else if(balance<=0){

      out.write("\n");
      out.write("\t\t\t\t<td align=\"left\"> :<input  type=\"text\" readonly value=\"");
      out.print(changeAmt);
      out.write("\" name=\"change\" ></td>\n");
 		} 

      out.write("\n");
      out.write("\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t<tr>\t\n");
      out.write("\t\t\t<td align=\"left\"><b>Expected Amount</b></td>\n");
      out.write("<!-- \t\t\t<td>: ");
      out.print(balance+(50 -(balance % 50)));
      out.write("</td>\t\t\n");
      out.write("\t\t\t<td align=\"left\">: ");
      out.print(balance+changeAmt);
      out.write("</td>\t\t-->\t\t\n");
      out.write("\t\t\n");
      out.write("\t\t\t<td align=\"left\">: <label id='expamtdiv' ></label></td>\t\t\t\n");
      out.write("\t\t</tr>\t\t\n");
      out.write("\t\t\n");
      out.write("\t\t<tr>\t\n");
      out.write("\t\t\t<td width=\"25%\" align=\"left\"><b>Delivery  Person </b></td>\n");
      out.write("\t\t\t<td align=\"left\" >\n");
	
	Connection conn=null;
	Statement stmt=null,stat=null;
	ResultSet rs=null,rs1=null;
	try {
		String code,desc,status_code_value="SUBMITTED",statusCode="",
			  prevStaffCode="",prevStaffName="",staffQuery="";
	    //staffQuery="SELECT o.dstaff_code, d.dstaff_name FROM orders o,delivery_staff d where o.order_num='"+orderNo+"' and o.dstaff_code=d.dstaff_code";
		staffQuery="select a.dstaff_code, a.dstaff_name from delivery_staff a, "+
				   "(select distinct (dstaff_code) from order_history where order_num='"+orderNo+"') b "+				   
				   "where a.dstaff_code=b.dstaff_code";	    
		Context initContext = new InitialContext();
		Context envContext  = (Context)initContext.lookup("java:/comp/env");
		DataSource ds = (DataSource)envContext.lookup("jdbc/js");
		conn = ds.getConnection();
		stmt = conn.createStatement();	
		//stat = conn.createStatement();	
		
		rs =stmt.executeQuery(staffQuery);
		while(rs.next()){
			prevStaffCode=rs.getString(1);
			prevStaffName=rs.getString(2);
			if(count==0)			
				StrWithComma=prevStaffName;
			else
				StrWithComma=StrWithComma+","+prevStaffName;			
			count++;
		}
		rs = stmt.executeQuery("select dstaff_code, dstaff_name from delivery_staff");

      out.write("\n");
      out.write("\t\t\t    \n");
      out.write("\t\t\t\t\t\t<SELECT name=\"d_staff\" >\n");
      out.write("\t\t\t\t\t\t<OPTION VALUE=\"\" >Select staff\n");
 
	
	 	while (rs.next()) {
	 		code = rs.getString(1);
	 		desc = rs.getString(2);

      out.write("\n");
      out.write("\t\t\t<OPTION VALUE=\"");
      out.print( code);
      out.write('"');
      out.write(' ');
      out.write('>');
      out.print( desc);
      out.write('\n');

		}	
		System.out.println("SELECT status_code, allow_action FROM status where status_code='"+status_code_value+"'");	
		rs1 = stmt.executeQuery("SELECT status_code, allow_action FROM status where status_code='"+status_code_value+"'");		

      out.write("\t\t\n");
      out.write("\n");
      out.write("\t\t\t</td>\n");
      out.write("\n");
      out.write("\t\t");
if(!prevStaffCode.equals("") && !prevStaffName.equals("")){
      out.write("\n");
      out.write("\t\t\t<tr><td><font color=#FF00CC sixe=2><b>This order was previously assigned to ");
      out.print(StrWithComma);
      out.write("</b></font></td></tr>\n");
      out.write("\t\t");
}
      out.write("\n");
      out.write("\t\n");
      out.write("\t\t\t<td width=\"20%\"><b>Allow Action : </b></td>\n");
      out.write("\t\t\t<td align=\"left\">\t\t\n");
      out.write("\t\t\t\t\t\t<SELECT name=\"allow_action\" >\n");
      out.write("\t\t\t\t\t\t<OPTION VALUE=\"\" >Select action\n");
      out.write("\n");
      out.write("\n");

		while(rs1.next()){
			statusCode=rs1.getString(1);
			actionValue=rs1.getString(2);
		}
		actionValueArray=actionValue.split(",");
		for(int index=0; index<actionValueArray.length; index++){
			System.out.println("index "+index+"\n actionValueArray[index] "+actionValueArray[index]);	

      out.write("\n");
      out.write("\t\t\t<OPTION VALUE=\"");
      out.print( index);
      out.write('"');
      out.write(' ');
      out.write('>');
      out.print( actionValueArray[index]);
      out.write('	');
      out.write('\n');

	}
	    conn.close();
	    rs.close();
	    rs1.close();
	    stmt.close();	    
	  }
	  catch (Exception e) {
	    rs.close();
	    rs1.close();
	    stmt.close();
	    conn.close();		  
        e.getMessage();
        e.printStackTrace();
      }
	    

      out.write("\t\t\n");
      out.write("\t\t\t</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t\n");
      out.write("\t\t</table>\n");
      out.write("\t\t</td><br>\t\n");
      out.write("\t\t<td valign=top align=right>\t\t\t\n");
      out.write("\t\t\t<div id=\"OrderHistory\" class=\"ddm1\"> </div> \n");
      out.write("\t\t</td>\n");
      out.write("\t\t</tr>\n");
      out.write("\t\t</table>\n");
      out.write("\t\t<tr><td align=\"center\" colspan=4>\t\t\n");
      out.write("\t<input type=\"submit\" name=\"Submit\"  disabled value=\"Save and Print<Alt+s>\" accesskey=\"s\" onClick=\"checkField();return false;\">\n");
      out.write("\t<input type=\"reset\" name=\"clear\" accesskey=\"r\" value=\"Clear <Alt+r>\">\n");
      out.write("\t<INPUT type=BUTTON value=\"Cancel <Alt+c>\" accesskey=\"c\" onClick=\"showMsg();\"></center>\n");
      out.write("</td></tr><hr>\n");
      out.write(" \t<input type=\"hidden\" name=\"horderNo\" value=\"");
      out.print(orderNo);
      out.write("\">\n");
      out.write(" \t<input type=\"hidden\" name=\"horderDate\" value=\"");
      out.print(orderDate);
      out.write("\"> \t\n");
      out.write(" \t<input type=\"hidden\" name=\"hstatus\" value=\"");
      out.print(status);
      out.write("\">\n");
      out.write(" \t<input type=\"hidden\" name=\"hallowaction\" value=\"\">\n");
      out.write("\t<input type=\"hidden\" name=\"hpagename\" value=\"DeliveryDetailsForm\"> \t \n");
      out.write("\t<input type=\"hidden\" name=\"hd_balance_ToPay\" value=\"");
      out.print(deliveryBalance);
      out.write("\">\n");
      out.write("\t<input type=\"hidden\" name=\"comm\" value=\"");
      out.print(comm_amt);
      out.write("\">\t\t\n");
      out.write("\t<div id=\"txtHint\" class=\"ddm1\">\t</div>\n");
      out.write("\t<p><h1><center><div id=\"waitMessage\"  style=\"cursor: sw-resize\"></center></div></h1></p>\n");
      out.write("\t\n");
      out.write("<script type=\"text/javascript\">\t\t\n");
      out.write("\t\tdocument.onkeydown = checkKey;\n");
      out.write("\t\tdocument.onclick = checkKey;\n");
      out.write("\t\tfunction checkKey() {\n");
      out.write("\t\t\tdocument.myform.Submit.disabled=false;\t\n");
      out.write("\t\t\t\t\t\n");
      out.write("\t\t}\n");
      out.write("\t\t\n");
      out.write("\t\tfunction setExpected(){\n");
      out.write("\t\t\tvar balance=\"");
      out.print(balance);
      out.write("\";\n");
      out.write("\t\t\tchange=document.myform.change.value;\n");
      out.write("\t\t\tif(change=='')\n");
      out.write("\t\t\t\tchange=0;\n");
      out.write("\t\t\telse \t\n");
      out.write("\t\t\t\tdocument.getElementById(\"expamtdiv\").innerHTML=parseFloat(balance)+parseFloat(change);\n");
      out.write("\n");
      out.write("\t\t}\n");
      out.write("\t\tfunction checkField(){\n");
      out.write("\t\t\tvar d_staff  = document.myform.d_staff.value;\t\n");
      out.write("\t\t\tvar allow_action = document.myform.allow_action.value;\t\n");
      out.write("\t\t\tvar d_staffnm = document.myform.d_staff[document.myform.d_staff.selectedIndex].text;\t\n");
      out.write("\t\t\tvar allow_actionnm = document.myform.allow_action[document.myform.allow_action.selectedIndex].text;\t\t\t\t\n");
      out.write("\t\t\tdocument.myform.hallowaction.value=allow_actionnm;\n");
      out.write("\t\t\tvar change =document.myform.change.value;\t\n");
      out.write("\t\t\tif(d_staff == \"\"){\n");
      out.write("\t\t\t\t\talert(\"Please Select Delivery Staff\");\n");
      out.write("\t\t\t\t\tdocument.myform.d_staff.focus();\n");
      out.write("\t\t\t\t\treturn false;\n");
      out.write("\t\t\t}\t\n");
      out.write("\t\t\tif(d_staff==\"\" && allow_actionnm==\"Send for delivery\") {\n");
      out.write("\t\t\t\t\talert(\"Please Select Delivery Staff\");\n");
      out.write("\t\t\t\t\tdocument.myform.d_staff.focus();\n");
      out.write("\t\t\t\t\treturn false;\n");
      out.write("\t\t\t}\n");
      out.write("\t\t\telse if(allow_action==\"\") {\n");
      out.write("\t\t\t\t\talert(\"Please Select Allow action\");\n");
      out.write("\t\t\t\t\tdocument.myform.allow_action.focus();\n");
      out.write("\t\t\t\t\treturn false;\n");
      out.write("\t\t\t}\n");
      out.write("\t\t\telse if(isNaN(change)) {\n");
      out.write("\t\t\t\talert(\"Please Enter a number in Change field\");\n");
      out.write("\t\t\t\tdocument.myform.change.value=\"\";\n");
      out.write("\t\t\t\tdocument.myform.change.focus();\n");
      out.write("\t\t\t\treturn false;\n");
      out.write("\t\t\t}\n");
      out.write("\t\t\telse{\t\n");
      out.write("\t\t\t\tif(allow_action==0){\n");
      out.write("\t\t\t\t\tvar ans=confirm(\"Do you want to send \"+ d_staffnm +\" to deliver the order: \"+ ");
      out.print(orderNo);
      out.write(");\t\t\t\n");
      out.write("\t\t\t\t\tif (ans==true){\t\n");
      out.write("\t\t\t\t\t\tdocument.myform.action = \"DeliveryDetails.jsp?subValue=");
      out.print(subValue);
      out.write("\";\n");
      out.write("\t\t\t\t\t\t//alert()\n");
      out.write("\t\t\t\t\t\tdocument.myform.submit(document.myform.action);\n");
      out.write("\t\t\t\t\t}\n");
      out.write("\t\t\t\t\telse{\n");
      out.write("\t\t\t\t\t  \twindow.refresh; \t\t\t  \t\n");
      out.write("\t\t\t\t\t}\n");
      out.write("\t\t\t\t}\n");
      out.write("\t\t\t\telse if(allow_action==1){\n");
      out.write("\t\t\t\t\tvar ans=confirm(\"Do you want to hold the order: \"+ ");
      out.print(orderNo);
      out.write(");\t\t\t\n");
      out.write("\t\t\t\t\tif (ans==true){\t\n");
      out.write("\t\t\t\t\t\tdocument.myform.action=\"DeliveryDetails.jsp?subValue=");
      out.print(subValue);
      out.write("\";\n");
      out.write("\t\t\t\t\t\tdocument.myform.submit();\n");
      out.write("\t\t\t\t\t}\n");
      out.write("\t\t\t\t\telse{\n");
      out.write("\t\t\t\t\t  \twindow.refresh; \t\t\t  \t\n");
      out.write("\t\t\t\t\t}\n");
      out.write("\t\t\t\t}\n");
      out.write("\t\t\t}\n");
      out.write("\t\t}\n");
      out.write("\t\tfunction showMsg(){\n");
      out.write("\t\t  \t //document.myform.action=\"SubmittedOrdersDetails.jsp\";\n");
      out.write("\t\t\t document.myform.action=\"TrackingForm.jsp\";\t\t  \t \n");
      out.write("\t\t   \t document.myform.submit();\n");
      out.write("\t\t}\n");
      out.write("\t\t//window.onload= showHint; \t\t\n");
      out.write("\t\twindow.onload= func\n");
      out.write("\t\tfunction func(){\n");
      out.write("\t\t\tshowHistory(); \n");
      out.write("\t\t\tdocument.getElementById(\"status\").innerHTML=\"");
      out.print(status);
      out.write("\";\n");
      out.write("\t\t\tdocument.getElementById(\"action\").innerHTML=\"");
      out.print(actionValue);
      out.write("\";\n");
      out.write("\t\t\tdocument.getElementById(\"expamtdiv\").innerHTML=\"");
      out.print(balance+changeAmt);
      out.write("\";\n");
      out.write("\t\t}\n");
      out.write("   \t</script>");
    } catch (java.lang.Throwable t) {
      if (!(t instanceof javax.servlet.jsp.SkipPageException)){
        out = _jspx_out;
        if (out != null && out.getBufferSize() != 0)
          try { out.clearBuffer(); } catch (java.io.IOException e) {}
        if (_jspx_page_context != null) _jspx_page_context.handlePageException(t);
        else throw new ServletException(t);
      }
    } finally {
      _jspxFactory.releasePageContext(_jspx_page_context);
    }
  }
}
